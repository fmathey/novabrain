var Novabrain=function(t){function r(n){if(e[n])return e[n].exports;var i=e[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}var e={};return r.m=t,r.c=e,r.p="",r(0)}([function(t,r,e){"use strict";t.exports={Neuron:e(1),Layer:e(3),Network:e(4),Trainer:e(5),Transfer:e(2)}},function(t,r,e){"use strict";function n(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(r,e,n){return e&&t(r.prototype,e),n&&t(r,n),r}}(),a=e(2),s=function(){function t(r){n(this,t),this.bias=.4*Math.random()-.2,this.weights=[];for(var e=0;r>e;e++)this.weights.push(.4*Math.random()-.2)}return i(t,[{key:"output",value:function(t,r){if(!Array.isArray(t))throw new Error("Inputs array expected");if(t.length!==this.weights.length)throw new Error("Inputs length "+this.weights.length+" expected");r=r||a.LOGISTIC;for(var e=this.bias,n=0,i=this.weights.length;i>n;n++)e+=this.weights[n]*t[n];return r(e)}},{key:"export",value:function(){return{bias:this.bias,weights:this.weights.slice()}}}]),t}();t.exports=s},function(t,r){"use strict";t.exports={LOGISTIC:function(t){return 1/(1+Math.exp(-t))},HARDLIMIT:function(t){return t>0?1:0},BOOLEAN:function(t){return t>0?!0:!1},IDENTITY:function(t){return t},TANH:function(t){var r=Math.exp(t),e=1/r;return(r-e)/(r+e)}}},function(t,r,e){"use strict";function n(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(r,e,n){return e&&t(r.prototype,e),n&&t(r,n),r}}(),a=e(1),s=function(){function t(r,e){n(this,t),this.neurons=[];for(var i=0;r>i;i++)this.neurons.push(new a(e))}return i(t,[{key:"output",value:function(t,r){var e=[];return this.neurons.forEach(function(n){e.push(n.output(t,r))}),e}},{key:"export",value:function(){var t=[];return this.neurons.forEach(function(r){t.push(r["export"]())}),t}}]),t}();t.exports=s},function(t,r,e){"use strict";function n(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(r,e,n){return e&&t(r.prototype,e),n&&t(r,n),r}}(),a=e(3),s=e(2),o=function(){function t(){n(this,t),this.layers=[];var r=Array.prototype.slice.call(arguments);if(2>r)throw new Error("Network expected 2 integers or more");2===r.length&&r.splice(1,0,Math.max(3,Math.floor(r[0]/2))),this.layers.push(new a(r[0],1));for(var e=1;e<r.length;e++)this.layers.push(new a(r[e],this.layers[e-1].neurons.length));this.transfer=s.LOGISTIC}return i(t,[{key:"output",value:function(t,r){for(var e=[],n=1;n<this.layers.length;n++)e=t=this.layers[n].output(t,r||this.transfer);return e}},{key:"export",value:function(){for(var t=[],r=0;r<this.layers.length;r++)t.push(this.layers[r]["export"]());return t}},{key:"import",value:function(r){if(r instanceof t&&(r=r["export"]()),r.length!==this.layers.length)throw new Error("Network expected ["+this.layers.length+"] layers");for(var e=0;e<this.layers.length;e++){var n=this.layers[e].neurons;if(r[e].length!==n.length)throw new Error("Layer ["+e+"] expected ["+n.length+"] neurons");for(var i=0;i<n.length;i++){var a=n[i];if(void 0===r[e][i].bias)throw new Error("Neuron ["+i+"] expected a [bias] value");if(a.bias=r[e][i].bias,!Array.isArray(r[e][i].weights))throw new Error("Neuron ["+i+"] expected a [weights] array of ["+a.weights.length+"] values");for(var s=0;s<a.weights.length;s++)a.weights[s]=r[e][i].weights[s]}}return this}},{key:"standalone",value:function(t){t=s.LOGISTIC.toString();var r=JSON.stringify(this["export"]()),e="";return e+="transfer = transfer || "+t+";",e+="var layers = "+r+";",e+="for (var i = 1; i < layers.length; i++) {",e+="var layer = layers[i];",e+="var outputs = [];",e+="for (var j = 0; j < layer.length; j++) {",e+="var neuron = layer[j];",e+="var result = neuron.bias;",e+="for (var k = 0; k < neuron.weights.length; k++) {",e+="result += neuron.weights[k] * inputs[k];",e+="}",e+="outputs[j] = transfer(result);",e+="}",e+="inputs = outputs;",e+="}",e+="return outputs;",new Function("inputs","transfer",e)}}]),t}();t.exports=o},function(t,r,e){"use strict";function n(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(r,e,n){return e&&t(r.prototype,e),n&&t(r,n),r}}(),a=e(4),s=function(){function t(r){if(n(this,t),!(r instanceof a))throw new Error("Network instance expected");this.network=r,this.inputSize=r.layers[0].neurons.length,this.outputSize=r.layers[r.layers.length-1].neurons.length,this.nbLayers=this.network.layers.length,this.lastLayerId=this.nbLayers-1,this.training={changes:[],iteration:{errors:[],deltas:[]}}}return i(t,[{key:"train",value:function(t,r){if(r=r||{},r.iterations=r.iterations||2e4,r.learning=r.learning||.3,r.momentum=r.momentum||.1,r.treshold=r.treshold||.005,r.callback=r.callback||null,r.interval=r.interval||10,!Array.isArray(t[0].input)||t[0].input.length!==this.inputSize)throw new Error("Train expected an input data array of "+this.inputSize);if(!Array.isArray(t[0].output)||t[0].output.length!==this.outputSize)throw new Error("Train expected an output data array of "+this.outputSize);this.changes=[];for(var e=10,n=0,i=0;i<r.iterations&&e>r.treshold;i++){for(var a=0,s=0;s<t.length;s++){var o=this.getOutputs(t[s].input),u=t[s].output;this.prepare(o,u),this.propagate(o,r.learning,r.momentum),a+=this.getErrorSum(this.training.iteration.errors[this.lastLayerId])}e=a/t.length,r.callback&&i%r.interval==0&&r.callback({error:e,iterations:i}),n++}return{error:e,iterations:n}}},{key:"prepare",value:function(t,r){this.training.iteration.errors=[],this.training.iteration.deltas=[];for(var e=this.lastLayerId;e>=0;e--){this.training.iteration.errors[e]=[],this.training.iteration.deltas[e]=[];for(var n=this.network.layers[e],i=0;i<n.neurons.length;i++){var a=t[e][i],s=0;if(e===this.lastLayerId)s=r[i]-a;else for(var o=this.training.iteration.deltas[e+1],u=0;u<o.length;u++){var h=this.network.layers[e+1].neurons[u].weights[i];s+=o[u]*h}this.training.iteration.errors[e][i]=s,this.training.iteration.deltas[e][i]=s*a*(1-a)}}return this}},{key:"propagate",value:function(t,r,e){this.training.changes.length!==this.nbLayers&&(this.training.changes=new Array(this.nbLayers));for(var n=1;n<this.nbLayers;n++){var i=t[n-1],a=this.network.layers[n];Array.isArray(this.training.changes[n])||(this.training.changes[n]=new Array(a.neurons.length));for(var s=0;s<a.neurons.length;s++){var o=a.neurons[s],u=this.training.iteration.deltas[n][s];Array.isArray(this.training.changes[n][s])||(this.training.changes[n][s]=new Array(o.weights.length));for(var h=0;h<i.length;h++){var l=this.training.changes[n][s][h]||0;l=r*u*i[h]+e*l,o.weights[h]+=l,this.training.changes[n][s][h]=l}o.bias+=r*u}}return this}},{key:"getOutputs",value:function(t){for(var r=[],e=r[0]=t.slice(),n=1;n<this.network.layers.length;n++)e=r[n]=this.network.layers[n].output(e);return r}},{key:"getErrorSum",value:function(t){var r=0;return t.forEach(function(t){r+=Math.pow(t,2)}),r/t.length}}]),t}();t.exports=s}]);